<!DOCTYPE html><html><head>
    <meta charset="UTF-8"/>
    <a class="dashingAutolink" name="autolink-11503"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Arrow"></a><title>Arrow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Functional companion to Kotlin&#39;s Standard Library"/>
    <meta name="keywords" content="functional-programming, kotlin-library, monads, monad-transformers, functional-data-structure, kotlin, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory"/>

    <meta property="og:image" content="http://arrow-kt.io/img/poster.png"/>
    <meta property="og:title" content="Arrow"/>
    <meta property="og:site_name" content="Arrow"/>
    <meta property="og:url" content="http://arrow-kt.io/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:description" content="Functional companion to Kotlin&#39;s Standard Library"/>
    <meta property="og:keywords" content="functional-programming, kotlin-library, monads, monad-transformers, functional-data-structure, kotlin, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory"/>

    <meta name="twitter:text:description" content="Functional companion to Kotlin&#39;s Standard Library"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@arrow_kt"/>
    <meta name="twitter:creator" content="@arrow_kt"/>
    <meta name="twitter:image" content="http://arrow-kt.io/img/twitter-card.png"/>

    <!-- Arrow versions metadata -->
    <meta name="previous-version" data-title="" data-url=""/>
    <meta name="stable-version" data-title="" data-url=""/>
    <meta name="next-version" data-title="" data-url=""/>

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css"/>
    <!-- Animated -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"/>
    <!-- Arrow main css -->
    <link rel="shortcut icon" href="../../../img/favicon.png"/>
    <!-- highlight  css -->
    <link rel="stylesheet" type="text/css" href="../../../css/highlight/atom-one-light.css"/>
    <!-- Arrow main css -->
    <link rel="stylesheet" type="text/css" href="../../../css/arrow.css"/>

    <!-- Code to manage version information -->
    <script src="../../../js/docVersions.js" defer=""></script>

    <!-- Diagrams support -->
    <script src="../../../js/dagre.min.js"></script>
    <script src="../../../js/lodash.min.js"></script>
    <script src="../../../js/nomnoml.js"></script>
    <script src="../../../js/diagrams.js" async=""></script>

    
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-18433785-18"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-18433785-18');
</script>

    
</head>

<body id="doc-body">
<div id="wrapper">
    <div id="sidebar-wrapper">
    <div class="sidebar-brand">
        <a class="brand" href="https://next.arrow-kt.io/">
            <img src="../../../img/arrow-brand-sidebar.svg" alt=""/>
            <span>&Lambda;rrow</span>
        </a>
        <button type="button" id="main-toggle" class="sidebar-toggle">
            <span class="close"></span>
        </button>
    </div>

    <ul class="sidebar-nav sidebar-doc-versions">
  <li class="sidebar-nav-item">
    <a href="index.html#">
      <span>Arrow version</span>
      <span id="arrow-version"></span>
    </a>
    <ul>
      <li>
        <a href="https://arrow-kt.io/docs/">
          <span>
            v0.9.0 - STABLE
          </span>
        </a>
      </li>

      <li>
        <a href="../../index.html">
            <span>
              v0.9.1 - NEXT
            </span>
        </a>
      </li>

      <li>
        <a href="https://0-8-2.arrow-kt.io/docs/">
            <span>
              v0.8.2 -
              PREVIOUS
            </span>
        </a>
      </li>

      
        
      
        
      
        
      
    </ul>
  </li>
</ul>


    <ul class="sidebar-nav">
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Quick Start</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../index.html">
                        <i class="fa fa-circle"></i>
                        <span>Index</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../quickstart/libraries/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Libraries</span>
                    </a>
                </li>
                
                <li>
                    <a href="https://next.arrow-kt.io/blog/">
                        <i class="fa fa-circle"></i>
                        <span>Blogs &amp; Presentations</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../quickstart/projects/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Projects &amp; Examples</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Arrow Fx</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../effects/fx/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Getting Started</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/fx/async/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Asynchronous &amp; Concurrent Programming</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/fx/polymorphism/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Polymorphism. One Program multiple runtimes</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>API Docs</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../apidocs/arrow-typeclasses/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Type Classes</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-core-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Data Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-core-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-extras/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extra Data Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-extras-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extra Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-kotlinx-coroutines-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Coroutines</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-kotlinx-coroutines-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Coroutines Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-rx2-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Rx2</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-rx2-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Rx2 Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-reactor-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Reactor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-reactor-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Reactor Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-streams/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Streams</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-mtl/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MTL</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-optics/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optics</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-recursion-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursion</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-recursion-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursion Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-generic/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Generic</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-free-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-validation/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Validation</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Patterns</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../glossary/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Glossary</span>
                    </a>
                </li>
                
                <li>
                    <a href="../error_handling/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Error Handling</span>
                    </a>
                </li>
                
                <li>
                    <a href="../dependency_injection/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Dependency Injection</span>
                    </a>
                </li>
                
                <li>
                    <a href="../monads/index.html">
                        <i class="fa fa-circle"></i>
                        <span>The Monad Tutorial</span>
                    </a>
                </li>
                
                <li>
                    <a href="index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monad Comprehensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../polymorphic_programs/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Polymorphic Programs</span>
                    </a>
                </li>
                
                <li>
                    <a href="../free_algebras/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free Algebras</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Data Types</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../datatypes/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../datatypes/basic/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Basic Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/option/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Option</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/either/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Either</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/try/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Try</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/validated/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Validated</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/nonemptylist/index.html">
                        <i class="fa fa-circle"></i>
                        <span>NonEmptyList</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/listk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>ListK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/sequencek/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SequenceK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/setk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SetK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/mapk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MapK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/sortedmapk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SortedMapK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/ior/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Ior</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/id/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Id</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/reader/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reader</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/kleisli/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Kleisli</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/state/index.html">
                        <i class="fa fa-circle"></i>
                        <span>State</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/statet/index.html">
                        <i class="fa fa-circle"></i>
                        <span>StateT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/store/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Store</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/moore/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Moore</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/sum/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Sum</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/day/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Day</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/writert/index.html">
                        <i class="fa fa-circle"></i>
                        <span>WriterT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/free/trampoline/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Trampoline</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/coproduct/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coproduct</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/eval/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Eval</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/optiont/index.html">
                        <i class="fa fa-circle"></i>
                        <span>OptionT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/data/eithert/index.html">
                        <i class="fa fa-circle"></i>
                        <span>EitherT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/function0/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Function0</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/core/function1/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Function1</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/const/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Const</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Type Classes</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../typeclasses/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/show/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Show</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/eq/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Eq</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/hash/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Hash</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/order/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Order</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/semigroup/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semigroup</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-typeclasses/arrow.typeclasses/-semigroupal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semigroupal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-typeclasses/arrow.typeclasses/-monoidal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monoidal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/monoid/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monoid</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-typeclasses/arrow.typeclasses/-semiring/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semiring</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/foldable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Foldable</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/bifoldable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bifoldable</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/traverse/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Traverse</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/reducible/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reducible</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/traversefilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>TraverseFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/functor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Functor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/functorfilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FunctorFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/applicative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Applicative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/applicativeerror/index.html">
                        <i class="fa fa-circle"></i>
                        <span>ApplicativeError</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/selective/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Selective</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/monad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/monaderror/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadError</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/effects/typeclasses/bracket/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bracket</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/monadfilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/monadreader/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadReader</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/monadwriter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadWriter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/monadstate/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadState</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/mtl/typeclasses/monadcombine/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadCombine</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/comonad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Comonad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/bimonad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bimonad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/bifunctor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bifunctor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/profunctor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Profunctor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/semigroupk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SemigroupK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/monoidk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonoidK</span>
                    </a>
                </li>
                
                <li>
                    <a href="https://next.arrow-kt.io/docs/typeclasses/inject/">
                        <i class="fa fa-circle"></i>
                        <span>Inject</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/alternative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Alternative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/divide/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Divide</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/divisible/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Divisible</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../arrow/typeclasses/decidable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Decidable</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Effects</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../effects/io/index.html">
                        <i class="fa fa-circle"></i>
                        <span>IO</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/monaddefer/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadDefer</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/async/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Async</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/effect/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effect</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/promise/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Promise</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/ref/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Ref</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/fiber/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fiber</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../apidocs/arrow-effects-data/arrow.effects/-resource/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Resource</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Optics</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../optics/dsl/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optics DSL</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/iso/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Iso</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/lens/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Lens</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/optional/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optional</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/prism/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Prism</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/getter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Getter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/setter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Setter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/fold/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fold</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/traversal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Traversal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/cons/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Cons</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/snoc/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Snoc</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/at/index.html">
                        <i class="fa fa-circle"></i>
                        <span>At</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/index/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Index</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/filterindex/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FilterIndex</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../optics/each/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Each</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>&Lambda;rrow Query Language</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../aql/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>&Lambda;rrow Query Language</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/select/index.html">
                        <i class="fa fa-circle"></i>
                        <span>select</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/from/index.html">
                        <i class="fa fa-circle"></i>
                        <span>from</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/where/index.html">
                        <i class="fa fa-circle"></i>
                        <span>where</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/groupby/index.html">
                        <i class="fa fa-circle"></i>
                        <span>groupBy</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/orderby/index.html">
                        <i class="fa fa-circle"></i>
                        <span>orderBy</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/sum/index.html">
                        <i class="fa fa-circle"></i>
                        <span>sum</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/union/index.html">
                        <i class="fa fa-circle"></i>
                        <span>union</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../aql/custom/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Custom Data Types</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Generic</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../generic/coproduct/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coproduct</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../generic/product/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Product</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Integrations</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../integrations/rx2/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Rx2</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../integrations/reactor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reactor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../integrations/kotlinxcoroutines/index.html">
                        <i class="fa fa-circle"></i>
                        <span>kotlinx.coroutines</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../integrations/retrofit/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Retrofit</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../integrations/kindedj/index.html">
                        <i class="fa fa-circle"></i>
                        <span>KindedJ</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Free</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../free/free/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../free/freeapplicative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FreeApplicative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../free/cofree/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Cofree</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../free/yoneda/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Yoneda</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../free/coyoneda/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coyoneda</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Recursion Schemes</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../recursion/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/recursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/corecursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Corecursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/birecursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Birecursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/mu/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Mu</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/nu/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Nu</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../recursion/fix/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fix</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Legal</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../legal/credits/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Credits</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../legal/licenses/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Licenses</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
    </ul>

</div>

    <div id="doc-wrapper">
    <div class="doc-header">
        <button type="button" id="main-toggle" class="sidebar-toggle">
            <i class="fa fa-lg fa-bars menu-icon"></i>
        </button>
        <div class="search-wrapper">
          <input id="docsearch" class="search" placeholder="Search documentation..." type="search"/>
        </div>
        <a target="_blank" href="https://github.com/arrow-kt/arrow/edit/master/modules/docs/arrow-docs/docs/docs/patterns/monadcomprehensions/README.md">
          <i class="fa fa-pencil"></i>
            Edit
        </a>
    </div>
    <div class="doc-content">
        
        <h2 id="monad-comprehensions">Monad Comprehensions</h2>

<p class="intermediate">intermediate</p>

<p>Monad comprehensions is the name for a programming idiom available in multiple languages like JavaScript, F#, Scala, or Haskell.
The purpose of monad comprehensions is to compose sequential chains of actions in a style that feels natural for programmers of all backgrounds.
They&rsquo;re similar to coroutines or async/await, but extensible to existing and new types!</p>

<p>Let&rsquo;s walk through the evolution of how code was written, up to where comprehensions are today.
It&rsquo;ll take a couple of sections to get there, so if you&rsquo;re familiar with <code class="highlighter-rouge">flatMap</code> feel free to skip to <a href="index.html#comprehensions-over-coroutines">Comprehensions over coroutines</a>.</p>

<h3 id="synchronous-sequences-of-actions">Synchronous sequences of actions</h3>

<p>A typical coding class starts teaching new programmers to think like an ideal computer. The computer is fed instructions one by one, and executed one after another.
The instructions modify the internal registers of this ideal computers to store and operate on values. As the values change over time, a result is returned and the program completes.</p>

<p>Let&rsquo;s see one example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int number = 0;
number += 1;
print(number);
return number;
</code></pre></div></div>

<p>This style of programming is what&rsquo;s usually called &ldquo;imperative programming&rdquo; after the fact of telling the computer what to do.
This style has grown over time over many programming languages with new paradigms, all with this underlying base.
It scaled during decades thanks to Moore&rsquo;s law, where computer became faster and faster at alarming paces. At some point in the past decade, Moore&rsquo;s law of vertical scaling plateaued near its theoretical limit.
Scaling started to become horizontal, with multiple cores working in parallel to achieve increasingly complex tasks.
This physical representation of cores became more apparent in software with the increase of multi-threading programs.</p>

<p>Mathematical laws for parallel programming have been known for decades, and applied in multiple languages.
They allow us to write sequenced code that can be run asynchronously over multiple threads, with assurances for completion.</p>

<h3 id="asynchronous-sequences-of-actions">Asynchronous sequences of actions</h3>

<p>The abstraction of sequencing execution of code is summarised in a single function that in Arrow is called <code class="highlighter-rouge">flatMap</code>,
although you may find it in other languages referred as <code class="highlighter-rouge">andThen</code>, <code class="highlighter-rouge">then</code>, <code class="highlighter-rouge">bind</code>, or <code class="highlighter-rouge">SelectMany</code>.
It takes as a parameter one function to be called after the current operation completes, and that function has to return another value to continue the operation with.
With knowledge of <code class="highlighter-rouge">flatMap</code> we can write sequential expressions that are ran asynchronously, even over multiple threads.</p>

<p>The <a href="https://next.arrow-kt.io/docs/typeclasses/intro">typeclass</a> interface that abstracts sequenced execution of code via <code class="highlighter-rouge">flatMap</code> is called a <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a>,
for which we also have a <a href="https://next.arrow-kt.io/docs/patterns/monads">tutorial</a>.</p>

<p>Implementations of <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a> are available for internal types like <code class="highlighter-rouge">Try</code> and also integrations like <a href="https://next.arrow-kt.io/docs/integrations/rx2">RxJava 2</a> and <a href="https://next.arrow-kt.io/docs/integrations/kotlinxcoroutines">kotlinx.coroutines</a>.
Let&rsquo;s see one example using a <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a> called <a href="https://next.arrow-kt.io/docs/effects/io"><code class="highlighter-rouge">IO</code></a>, where we fetch from a database the information about the dean of university some student attends:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">university</span><span class="p">:</span> <span class="n">IO</span><span class="p">&lt;</span><span class="n">University</span><span class="p">&gt;</span> <span class="p">=</span> 
  <span class="n">getStudentFromDatabase</span><span class="p">(</span><span class="s">&#34;Bob Roxx&#34;</span><span class="p">).</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">student</span> <span class="p">-&gt;</span>
      <span class="n">getUniversityFromDatabase</span><span class="p">(</span><span class="n">student</span><span class="p">.</span><span class="n">universityId</span><span class="p">).</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">university</span> <span class="p">-&gt;</span>
        <span class="n">getDeanFromDatabase</span><span class="p">(</span><span class="n">university</span><span class="p">.</span><span class="n">deanId</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>The sequence of events is assured in that <code class="highlighter-rouge">getUniversityFromDatabase</code> will not be called until <code class="highlighter-rouge">getStudentFromDatabase</code> returns a result.
If <code class="highlighter-rouge">getStudentFromDatabase</code> fails, then <code class="highlighter-rouge">getUniversityFromDatabase</code> will never be called.
That same way, if <code class="highlighter-rouge">getUniversityFromDatabase</code> then <code class="highlighter-rouge">getDeanFromDatabase</code> will never be called. Error handling propagates through the chain.</p>

<p>While this coding style is an improvement for asynchrony, the readability for users accustomed to traditional imperative code suffers.
Computer science can bring us a construct to get the best of both styles.</p>

<h3 id="comprehensions-over-coroutines">Comprehensions over coroutines</h3>

<p>This feature is known with multiple names: async/await, coroutines, do notation, for comprehensions&hellip;each version contains certain unique points but all derive from the same principles.
In Kotlin, coroutines (introduced in version 1.1 of the language) make the compiler capable of rewriting seemingly synchronous code into asynchronous sequences.
Arrow uses this capability of the compiler to bring you coroutines-like notation to all instances of the <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a> typeclass.</p>

<p>This means that comprehensions are available for <code class="highlighter-rouge">Option</code>, <code class="highlighter-rouge">Try</code>, <code class="highlighter-rouge">List</code>, <code class="highlighter-rouge">Reader</code>, <code class="highlighter-rouge">Observable</code>, <code class="highlighter-rouge">Flux</code> or <code class="highlighter-rouge">IO</code> all the same.
In the following examples we&rsquo;ll use <code class="highlighter-rouge">IO</code> as it&rsquo;s a simple concurrency primitive with straightforward behavior.</p>

<p>Every instance of <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a> contains a method <code class="highlighter-rouge">binding</code> that receives a suspended function as a parameter.
This functions must return the last element of the sequence of operations.
Let&rsquo;s see a minimal example.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.*</span>
<span class="k">import</span> <span class="nn">arrow.effects.*</span>
<span class="k">import</span> <span class="nn">arrow.typeclasses.*</span>
<span class="k">import</span> <span class="nn">arrow.effects.extensions.io.monad.*</span>

<span class="n">binding</span> <span class="p">{</span>
  <span class="m">1</span>
<span class="p">}.</span><span class="n">fix</span><span class="p">().</span><span class="n">unsafeRunSync</span><span class="p">()</span>
<span class="c1">// 1</span>
</code></pre></div></div>

<p>Anything in the function inside <code class="highlighter-rouge">binding</code> can be imperative and sequential code that&rsquo;ll be executed when the data type decides.
In the case of <a href="https://next.arrow-kt.io/docs/effects/io"><code class="highlighter-rouge">IO</code></a>, it is immediately run blocking the current thread using <code class="highlighter-rouge">unsafeRunSync()</code>. Let&rsquo;s expand the example by adding a second operation:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">binding</span> <span class="p">{</span>
  <span class="kd">val</span> <span class="py">a</span> <span class="p">=</span> <span class="n">IO</span><span class="p">.</span><span class="n">invoke</span> <span class="p">{</span> <span class="m">1</span> <span class="p">}</span>
  <span class="n">a</span> <span class="p">+</span> <span class="m">1</span>
<span class="p">}.</span><span class="n">fix</span><span class="p">().</span><span class="n">unsafeRunSync</span><span class="p">()</span>
<span class="c1">// Compiler error: the type of a is IO&lt;Int&gt;, cannot add 1 to it</span>
</code></pre></div></div>

<p>This is our first challenge. We&rsquo;ve created an instance of <a href="https://next.arrow-kt.io/docs/effects/io"><code class="highlighter-rouge">IO</code></a> that&rsquo;ll run a block asynchronously, and we cannot get the value from inside it.
From the previous snippet the first intuition would be to call <code class="highlighter-rouge">unsafeRunSync()</code> on <code class="highlighter-rouge">a</code> to get the value.
This will block the current thread until the operation completes. What we want is to, instead, run and await until <code class="highlighter-rouge">a</code> completes before yielding the result.
For that we have two flavors of the function <code class="highlighter-rouge">bind()</code>, which is a function only available inside the function passed to <code class="highlighter-rouge">binding()</code>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">binding</span> <span class="p">{</span>
  <span class="kd">val</span> <span class="p">(</span><span class="py">a</span><span class="p">)</span> <span class="p">=</span> <span class="n">IO</span><span class="p">.</span><span class="n">invoke</span> <span class="p">{</span> <span class="m">1</span> <span class="p">}</span>
  <span class="n">a</span> <span class="p">+</span> <span class="m">1</span>
<span class="p">}.</span><span class="n">fix</span><span class="p">().</span><span class="n">unsafeRunSync</span><span class="p">()</span>
<span class="c1">// 2</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">binding</span> <span class="p">{</span>
  <span class="kd">val</span> <span class="py">a</span> <span class="p">=</span> <span class="n">bind</span> <span class="p">{</span> <span class="n">IO</span><span class="p">.</span><span class="n">invoke</span> <span class="p">{</span> <span class="m">1</span> <span class="p">}</span> <span class="p">}</span>
  <span class="n">a</span> <span class="p">+</span> <span class="m">1</span>
<span class="p">}.</span><span class="n">fix</span><span class="p">().</span><span class="n">unsafeRunSync</span><span class="p">()</span>
<span class="c1">// 2</span>
</code></pre></div></div>

<p>What <code class="highlighter-rouge">bind()</code> does is use the rest of the sequential operations as the function you&rsquo;d normally pass to <code class="highlighter-rouge">flatMap</code>.
The equivalent code without using comprehensions would look like:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">IO</span><span class="p">.</span><span class="n">invoke</span> <span class="p">{</span> <span class="m">1</span> <span class="p">}</span>
  <span class="p">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">result</span> <span class="p">-&gt;</span>
    <span class="n">IO</span><span class="p">.</span><span class="n">just</span><span class="p">(</span><span class="n">result</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">.</span><span class="n">fix</span><span class="p">().</span><span class="n">unsafeRunSync</span><span class="p">()</span>
<span class="c1">// 2</span>
</code></pre></div></div>

<p>With this new style we can rewrite our original example of database fetching as:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">university</span><span class="p">:</span> <span class="n">IO</span><span class="p">&lt;</span><span class="n">University</span><span class="p">&gt;</span> <span class="p">=</span> 
  <span class="n">binding</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">student</span><span class="p">)</span> <span class="p">=</span> <span class="n">getStudentFromDatabase</span><span class="p">(</span><span class="s">&#34;Bob Roxx&#34;</span><span class="p">)</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">university</span><span class="p">)</span> <span class="p">=</span> <span class="n">getUniversityFromDatabase</span><span class="p">(</span><span class="n">student</span><span class="p">.</span><span class="n">universityId</span><span class="p">)</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">dean</span><span class="p">)</span> <span class="p">=</span> <span class="n">getDeanFromDatabase</span><span class="p">(</span><span class="n">university</span><span class="p">.</span><span class="n">deanId</span><span class="p">)</span>
    <span class="n">dean</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>And you can still write your usual imperative code in the binding block, interleaved with code that returns instances of <a href="https://next.arrow-kt.io/docs/effects/io"><code class="highlighter-rouge">IO</code></a>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">getNLines</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="nc">FilePath</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="nc">Int</span><span class="p">):</span> <span class="nc">IO</span><span class="p">&lt;</span><span class="nc">List</span><span class="err">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> 
  <span class="n">binding</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">file</span><span class="p">)</span> <span class="p">=</span> <span class="n">getFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">lines</span><span class="p">)</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">readLines</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lines</span><span class="p">.</span><span class="n">length</span> <span class="p">&lt;</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">IO</span><span class="p">.</span><span class="n">raiseError</span><span class="p">(</span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">&#34;File has fewer lines than expected&#34;</span><span class="p">)).</span><span class="n">bind</span><span class="p">()</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">lines</span><span class="p">.</span><span class="n">take</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>While this looks like a great improvement to manually raise errors sometimes you will encounter unexpected behavior and exceptions in seemingly normal code.</p>

<h3 id="error-propagation-in-comprehensions">Error propagation in comprehensions</h3>

<p>While <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a> represents sequential code, it doesn&rsquo;t account for an existing execution flow pattern: exceptions.
Exceptions work like old goto that can happen at any point during execution and stop the current block to jump to a catch block.</p>

<p>Let&rsquo;s take a somewhat common mistake and expand on it:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">getLineLengthAverage</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="nc">FilePath</span><span class="p">):</span> <span class="nc">IO</span><span class="p">&lt;</span><span class="nc">List</span><span class="err">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> 
  <span class="n">binding</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">file</span><span class="p">)</span> <span class="p">=</span> <span class="n">getFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">lines</span><span class="p">)</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">readLines</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">count</span> <span class="p">=</span> <span class="n">lines</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">length</span> <span class="p">}.</span><span class="n">foldLeft</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">acc</span><span class="p">,</span> <span class="n">lineLength</span> <span class="p">-&gt;</span> <span class="n">acc</span> <span class="p">+</span> <span class="n">lineLength</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">average</span> <span class="p">=</span> <span class="n">count</span> <span class="p">/</span> <span class="n">lines</span><span class="p">.</span><span class="n">length</span>
    <span class="n">average</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>What would happen if the file contains 0 lines? The chain throws ArithmeticException with a division by 0!
This exception goes uncaught and finalizes the program with a crash. Knowing this it is obvious we can do better.</p>

<p>Our next approach can do automatic wrapping of unexpected exceptions to return them inside the operation sequence.
For this purpose, the typeclass <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monaderror"><code class="highlighter-rouge">MonadError</code></a> was created.
<a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monaderror"><code class="highlighter-rouge">MonadError</code></a> allows us to raise and recover from errors.
It also contains a version of comprehensions that automatically wraps exceptions, called <code class="highlighter-rouge">bindingCatch</code>.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">getLineLengthAverage</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="nc">FilePath</span><span class="p">):</span> <span class="nc">IO</span><span class="p">&lt;</span><span class="nc">List</span><span class="err">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> 
  <span class="n">bindingCatch</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">file</span><span class="p">)</span> <span class="p">=</span> <span class="n">getFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">lines</span><span class="p">)</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">readLines</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">count</span> <span class="p">=</span> <span class="n">lines</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">length</span> <span class="p">}.</span><span class="n">foldLeft</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">acc</span><span class="p">,</span> <span class="n">lineLength</span> <span class="p">-&gt;</span> <span class="n">acc</span> <span class="p">+</span> <span class="n">lineLength</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">average</span> <span class="p">=</span> <span class="n">count</span> <span class="p">/</span> <span class="n">lines</span><span class="p">.</span><span class="n">length</span>
    <span class="n">average</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>With a small change we get handling of exceptions even within the binding block.
This wrapping works the same way as if we raised an error as the return from <code class="highlighter-rouge">getFile()</code> or <code class="highlighter-rouge">readLines()</code>, short-circuiting and stopping the sequence early.</p>

<p>Note that while most data types include an instance of <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monaderror"><code class="highlighter-rouge">MonadError</code></a> is somewhat less common.</p>

<h3 id="what-about-those-threads">What about those threads?</h3>

<p>Arrow uses the same abstraction as coroutines to group threads and other contexts of execution: <code class="highlighter-rouge">CoroutineContext</code>.
There are multiple default values and wrappers for common cases in both the standard library, and the extension library <a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html">kotlinx.coroutines</a>.</p>

<h4 id="blocking-thread-jumps">Blocking thread jumps</h4>

<p>NOTE: This blocking approach to thread jumping will change before the 1.0 release, as it&rsquo;s causing non-blocking datatypes to behave as if they were blocking.</p>

<p>In any <code class="highlighter-rouge">binding()</code> block there is a helper function <code class="highlighter-rouge">bindIn()</code> that takes a <code class="highlighter-rouge">CoroutineContext</code> as a parameter and can return any value.
This value will be lifted into a data type using <code class="highlighter-rouge">just()</code>.</p>

<p>The functions will cause a new coroutine to start on the <code class="highlighter-rouge">CoroutineContext</code> passed as a parameter to then <code class="highlighter-rouge">bind()</code> to await for its completion.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">ioThreadContext</span> <span class="p">=</span> <span class="n">newSingleThreadContext</span><span class="p">(</span><span class="s">&#34;IO&#34;</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">computationThreadContext</span> <span class="p">=</span> <span class="n">newSingleThreadContext</span><span class="p">(</span><span class="s">&#34;Computation&#34;</span><span class="p">)</span>

<span class="k">fun</span> <span class="nf">getLineLengthAverage</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="nc">FilePath</span><span class="p">):</span> <span class="nc">IO</span><span class="p">&lt;</span><span class="nc">List</span><span class="err">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> 
  <span class="n">bindingCatch</span> <span class="p">{</span>
    
    <span class="c1">// Implicitly wrap the result of a synchronous operation into IO.just() using bindIn</span>
    <span class="kd">val</span> <span class="py">file</span> <span class="p">=</span> <span class="n">bindIn</span><span class="p">(</span><span class="n">ioThreadContext</span><span class="p">)</span> <span class="p">{</span> <span class="n">getFile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">}</span>    
    <span class="kd">val</span> <span class="py">lines</span> <span class="p">=</span> <span class="n">bindIn</span><span class="p">(</span><span class="n">computationThreadContext</span><span class="p">)</span> <span class="p">{</span> <span class="n">file</span><span class="p">.</span><span class="n">readLines</span><span class="p">()</span> <span class="p">}</span>
    
    <span class="kd">val</span> <span class="py">count</span> <span class="p">=</span> <span class="n">lines</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">length</span> <span class="p">}.</span><span class="n">foldLeft</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">acc</span><span class="p">,</span> <span class="n">lineLength</span> <span class="p">-&gt;</span> <span class="n">acc</span> <span class="p">+</span> <span class="n">lineLength</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">average</span> <span class="p">=</span> <span class="n">count</span> <span class="p">/</span> <span class="n">lines</span><span class="p">.</span><span class="n">length</span>
    <span class="n">average</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>Note that <code class="highlighter-rouge">bindIn()</code>assures that the execution will return to the same thread where the binding started after the <code class="highlighter-rouge">bindIn</code> block executes.</p>

<p>There is also a version of <code class="highlighter-rouge">bindIn</code> called <code class="highlighter-rouge">bindDeferredIn</code> that allows deferred construction.
It&rsquo;s available for <code class="highlighter-rouge">bindingCancellable</code> comprehensions over instances of <a href="https://next.arrow-kt.io/docs/effects/monaddefer"><code class="highlighter-rouge">MonadDefer</code></a>.</p>

<h4 id="non-blocking-thread-jumps">Non-blocking thread jumps</h4>

<p>Any datatype that allows asynchronous execution has to be abstracted by the typeclass <a href="https://next.arrow-kt.io/docs/effects/aync"><code class="highlighter-rouge">Async</code></a>.
Thus, it&rsquo;s only logical that these datatypes allow for non-blocking thread jumping.</p>

<p>The typeclass <a href="https://next.arrow-kt.io/docs/effects/aync"><code class="highlighter-rouge">Async</code></a> defines an extension function for comprehensions that enables continuing the execution on a new thread.
This function is called <code class="highlighter-rouge">continueOn()</code>, takes a <code class="highlighter-rouge">CoroutineContext</code> and applies the effect of jumping to it, without any value returned.
The rest of the continuation will be executed on that <code class="highlighter-rouge">CoroutineContext</code>. Simple as that.</p>

<p>Let&rsquo;s see an example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IO.async().run {
  binding {
    // In current thread
    val (id) = createIdFromNumber(762587)
    continueOn(CommonPool)

    // In CommonPool now!
    val (result) = request(id)
    continueOn(Ui)

    // In Ui now!
    showResult(result)
  }
}
</code></pre></div></div>

<p>Behind the scenes <code class="highlighter-rouge">continueOn()</code> starts a new coroutine and passes the rest of the execution as the block to execute.
It&rsquo;s worth reminding that this means that you have to precompute thread local values like a thread name before doing the jump.</p>

<h3 id="what-if-id-like-to-run-multiple-operations-independently-from-each-other-in-a-non-sequential-way">What if I&rsquo;d like to run multiple operations independently from each other, in a non-sequential way?</h3>

<p>You can check the section on the Applicative Builder pattern for them!</p>

<h3 id="cancellation-and-cleanup-of-resources">Cancellation and cleanup of resources</h3>

<p>In some environments that have resources with their own lifecycle (i.e. Activity in Android development) retaining these values in operations that can run indefinitely may cause large memory leaks and lead to undefined behavior.
As cleanup is important in these restricted environments, any instance of <a href="https://next.arrow-kt.io/docs/effects/monaddefer"><code class="highlighter-rouge">MonadDefer</code></a> provides the function <code class="highlighter-rouge">bindingCancellable</code>, which allows for comprehensions to be finished early by throwing an <code class="highlighter-rouge">BindingCancellationException</code> at the beginning of the next <code class="highlighter-rouge">bind()</code> step.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="p">(</span><span class="py">binding</span><span class="err">:</span> <span class="py">IO</span><span class="err">&lt;</span><span class="py">List</span><span class="err">&lt;</span><span class="py">User</span><span class="err">&gt;&gt;</span><span class="p">,</span> <span class="py">unsafeCancel</span><span class="err">:</span> <span class="py">Disposable</span><span class="p">)</span> <span class="p">=</span>
  <span class="n">ioSync</span><span class="p">.</span><span class="n">bindingCancellable</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">userProfile</span> <span class="p">=</span> <span class="n">bindDefer</span> <span class="p">{</span> <span class="n">getUserProfile</span><span class="p">(</span><span class="s">&#34;123&#34;</span><span class="p">)</span> <span class="p">}</span>
    <span class="kd">val</span> <span class="py">friendProfiles</span> <span class="p">=</span> <span class="n">userProfile</span><span class="p">.</span><span class="n">friends</span><span class="p">().</span><span class="n">map</span> <span class="p">{</span> <span class="n">friend</span> <span class="p">-&gt;</span>
        <span class="n">bindDefer</span> <span class="p">{</span> <span class="n">getProfile</span><span class="p">(</span><span class="n">friend</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">listOf</span><span class="p">(</span><span class="n">userProfile</span><span class="p">)</span> <span class="p">+</span> <span class="n">friendProfiles</span>
  <span class="p">}</span>

<span class="n">binding</span><span class="p">.</span><span class="n">unsafeRunAsync</span> <span class="p">{</span> <span class="n">result</span> <span class="p">-&gt;</span>
  <span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">({</span> <span class="n">println</span><span class="p">(</span><span class="s">&#34;Boom! caused by $it&#34;</span><span class="p">)</span> <span class="p">},</span> <span class="p">{</span> <span class="n">println</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">toString</span><span class="p">())</span> <span class="p">})</span>
<span class="p">}</span>

<span class="n">unsafeCancel</span><span class="p">()</span>
<span class="c1">// Boom! caused by BindingCancellationException</span>
</code></pre></div></div>

<p>Note that the cancellation happens on the <code class="highlighter-rouge">bind()</code> step, so any currently running operations before <code class="highlighter-rouge">bind()</code> will have to complete first, even those that are scheduled for threading.</p>

    </div>
</div>

</div>
<!-- Jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Arrow playground -->
<script src="https://unpkg.com/arrow-playground@1" data-selector="[class^=&#39;language-kotlin&#39;]"></script>
<!-- Highlight -->
<script src="../../../js/highlight.pack.js"></script>
<script>
  hljs.initHighlighting();
</script>
<!-- Docsearch -->
<script type="text/javascript" src="../../../js/docsearch.min.js"></script>
<!-- Custom scripts for this template -->
<script src="../../../js/functions.js"></script>
<!-- Gitter -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'arrow-kt/Lobby'
  };

</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script>



</body></html>