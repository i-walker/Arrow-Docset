<!DOCTYPE html>
<html>




<head>
    <meta charset="UTF-8">
    <title>Arrow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Functional companion to Kotlin's Standard Library">
    <meta name="keywords" content="functional-programming, kotlin-library, monads, monad-transformers, functional-data-structure, kotlin, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory">

    <meta property="og:image" content="http://arrow-kt.io/img/poster.png"/>
    <meta property="og:title" content="Arrow"/>
    <meta property="og:site_name" content="Arrow"/>
    <meta property="og:url" content="http://arrow-kt.io/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:description" content="Functional companion to Kotlin's Standard Library"/>
    <meta property="og:keywords" content="functional-programming, kotlin-library, monads, monad-transformers, functional-data-structure, kotlin, fp-types, adt, free-monads, tagless-final, mtl, for-comprehension, category-theory"/>

    <meta name="twitter:text:description" content="Functional companion to Kotlin's Standard Library"/>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@arrow_kt">
    <meta name="twitter:creator" content="@arrow_kt">
    <meta name="twitter:image" content="http://arrow-kt.io/img/twitter-card.png"/>

    <!-- Arrow versions metadata -->
    <meta name="previous-version" data-title="" data-url="" />
    <meta name="stable-version" data-title="" data-url="" />
    <meta name="next-version" data-title="" data-url="" />

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet"
          type="text/css">
    <!-- Animated -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <!-- Arrow main css -->
    <link rel="shortcut icon" href="../../../../img/favicon.png">
    <!-- highlight  css -->
    <link rel="stylesheet" type="text/css" href="../../../../css/highlight/atom-one-light.css">
    <!-- Arrow main css -->
    <link rel="stylesheet" type="text/css" href="../../../../css/arrow.css">

    <!-- Code to manage version information -->
    <script src="../../../../js/docVersions.js" defer></script>

    <!-- Diagrams support -->
    <script src="../../../../js/dagre.min.js"></script>
    <script src="../../../../js/lodash.min.js"></script>
    <script src="../../../../js/nomnoml.js"></script>
    <script src="../../../../js/diagrams.js" async></script>

    
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-18433785-18"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-18433785-18');
</script>

    
</head>

<body id="doc-body">
<div id="wrapper">
    <div id="sidebar-wrapper">
    <div class="sidebar-brand">
        <a class="brand" href="https://next.arrow-kt.io/">
            <img src="../../../../img/arrow-brand-sidebar.svg" alt="">
            <span>Î›rrow</span>
        </a>
        <button type="button" id="main-toggle" class="sidebar-toggle">
            <span class="close"></span>
        </button>
    </div>

    <ul class="sidebar-nav sidebar-doc-versions">
  <li class="sidebar-nav-item">
    <a href="index.html#">
      <span>Arrow version</span>
      <span id="arrow-version"></span>
    </a>
    <ul>
      <li>
        <a href="https://arrow-kt.io/docs/">
          <span>
            v0.9.0 - STABLE
          </span>
        </a>
      </li>

      <li>
        <a href="../../../index.html">
            <span>
              v0.9.1 - NEXT
            </span>
        </a>
      </li>

      <li>
        <a href="https://0-8-2.arrow-kt.io/docs/">
            <span>
              v0.8.2 -
              PREVIOUS
            </span>
        </a>
      </li>

      
        
      
        
      
        
      
    </ul>
  </li>
</ul>


    <ul class="sidebar-nav">
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Quick Start</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../index.html">
                        <i class="fa fa-circle"></i>
                        <span>Index</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../quickstart/libraries/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Libraries</span>
                    </a>
                </li>
                
                <li>
                    <a href="https://next.arrow-kt.io/blog/">
                        <i class="fa fa-circle"></i>
                        <span>Blogs & Presentations</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../quickstart/projects/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Projects & Examples</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Arrow Fx</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../effects/fx/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Getting Started</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/fx/async/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Asynchronous & Concurrent Programming</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/fx/polymorphism/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Polymorphism. One Program multiple runtimes</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>API Docs</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../apidocs/arrow-typeclasses/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Type Classes</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-core-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Data Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-core-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-extras/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extra Data Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-extras-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Core Extra Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-kotlinx-coroutines-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Coroutines</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-kotlinx-coroutines-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Coroutines Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-rx2-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Rx2</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-rx2-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Rx2 Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-reactor-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Reactor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-reactor-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effects Reactor Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-streams/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Streams</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-mtl/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MTL</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-optics/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optics</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-recursion-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursion</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-recursion-extensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursion Extensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-generic/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Generic</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-free-data/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-validation/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Validation</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Patterns</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../patterns/glossary/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Glossary</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/error_handling/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Error Handling</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/dependency_injection/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Dependency Injection</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/monads/index.html">
                        <i class="fa fa-circle"></i>
                        <span>The Monad Tutorial</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/monad_comprehensions/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monad Comprehensions</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/polymorphic_programs/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Polymorphic Programs</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../patterns/free_algebras/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free Algebras</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Data Types</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../datatypes/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../datatypes/basic/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Basic Types</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/option/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Option</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/either/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Either</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/try/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Try</span>
                    </a>
                </li>
                
                <li>
                    <a href="../validated/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Validated</span>
                    </a>
                </li>
                
                <li>
                    <a href="../nonemptylist/index.html">
                        <i class="fa fa-circle"></i>
                        <span>NonEmptyList</span>
                    </a>
                </li>
                
                <li>
                    <a href="../listk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>ListK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../sequencek/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SequenceK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../setk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SetK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../mapk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MapK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../sortedmapk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SortedMapK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../ior/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Ior</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/id/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Id</span>
                    </a>
                </li>
                
                <li>
                    <a href="../reader/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reader</span>
                    </a>
                </li>
                
                <li>
                    <a href="../kleisli/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Kleisli</span>
                    </a>
                </li>
                
                <li>
                    <a href="../state/index.html">
                        <i class="fa fa-circle"></i>
                        <span>State</span>
                    </a>
                </li>
                
                <li>
                    <a href="../statet/index.html">
                        <i class="fa fa-circle"></i>
                        <span>StateT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../store/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Store</span>
                    </a>
                </li>
                
                <li>
                    <a href="../moore/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Moore</span>
                    </a>
                </li>
                
                <li>
                    <a href="../sum/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Sum</span>
                    </a>
                </li>
                
                <li>
                    <a href="../day/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Day</span>
                    </a>
                </li>
                
                <li>
                    <a href="../writert/index.html">
                        <i class="fa fa-circle"></i>
                        <span>WriterT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../free/trampoline/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Trampoline</span>
                    </a>
                </li>
                
                <li>
                    <a href="../coproduct/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coproduct</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/eval/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Eval</span>
                    </a>
                </li>
                
                <li>
                    <a href="../optiont/index.html">
                        <i class="fa fa-circle"></i>
                        <span>OptionT</span>
                    </a>
                </li>
                
                <li>
                    <a href="index.html">
                        <i class="fa fa-circle"></i>
                        <span>EitherT</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/function0/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Function0</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../core/function1/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Function1</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/const/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Const</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Type Classes</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../typeclasses/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/show/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Show</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/eq/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Eq</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/hash/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Hash</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/order/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Order</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/semigroup/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semigroup</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-typeclasses/arrow.typeclasses/-semigroupal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semigroupal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-typeclasses/arrow.typeclasses/-monoidal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monoidal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/monoid/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monoid</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-typeclasses/arrow.typeclasses/-semiring/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Semiring</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/foldable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Foldable</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/bifoldable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bifoldable</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/traverse/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Traverse</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/reducible/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reducible</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/traversefilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>TraverseFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/functor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Functor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/functorfilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FunctorFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/applicative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Applicative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/applicativeerror/index.html">
                        <i class="fa fa-circle"></i>
                        <span>ApplicativeError</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/selective/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Selective</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/monad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Monad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/monaderror/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadError</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../effects/typeclasses/bracket/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bracket</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/monadfilter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadFilter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/monadreader/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadReader</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/monadwriter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadWriter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/monadstate/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadState</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../mtl/typeclasses/monadcombine/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadCombine</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/comonad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Comonad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/bimonad/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bimonad</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/bifunctor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Bifunctor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/profunctor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Profunctor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/semigroupk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>SemigroupK</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/monoidk/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonoidK</span>
                    </a>
                </li>
                
                <li>
                    <a href="https://next.arrow-kt.io/docs/typeclasses/inject/">
                        <i class="fa fa-circle"></i>
                        <span>Inject</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/alternative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Alternative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/divide/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Divide</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/divisible/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Divisible</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../typeclasses/decidable/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Decidable</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Effects</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../effects/io/index.html">
                        <i class="fa fa-circle"></i>
                        <span>IO</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/monaddefer/index.html">
                        <i class="fa fa-circle"></i>
                        <span>MonadDefer</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/async/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Async</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/effect/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Effect</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/promise/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Promise</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/ref/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Ref</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../effects/fiber/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fiber</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../apidocs/arrow-effects-data/arrow.effects/-resource/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Resource</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Optics</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../optics/dsl/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optics DSL</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/iso/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Iso</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/lens/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Lens</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/optional/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Optional</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/prism/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Prism</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/getter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Getter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/setter/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Setter</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/fold/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fold</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/traversal/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Traversal</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/cons/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Cons</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/snoc/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Snoc</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/at/index.html">
                        <i class="fa fa-circle"></i>
                        <span>At</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/index/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Index</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/filterindex/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FilterIndex</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../optics/each/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Each</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Î›rrow Query Language</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../aql/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Î›rrow Query Language</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/select/index.html">
                        <i class="fa fa-circle"></i>
                        <span>select</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/from/index.html">
                        <i class="fa fa-circle"></i>
                        <span>from</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/where/index.html">
                        <i class="fa fa-circle"></i>
                        <span>where</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/groupby/index.html">
                        <i class="fa fa-circle"></i>
                        <span>groupBy</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/orderby/index.html">
                        <i class="fa fa-circle"></i>
                        <span>orderBy</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/sum/index.html">
                        <i class="fa fa-circle"></i>
                        <span>sum</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/union/index.html">
                        <i class="fa fa-circle"></i>
                        <span>union</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../aql/custom/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Custom Data Types</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Generic</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../generic/coproduct/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coproduct</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../generic/product/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Product</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Integrations</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../integrations/rx2/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Rx2</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../integrations/reactor/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Reactor</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../integrations/kotlinxcoroutines/index.html">
                        <i class="fa fa-circle"></i>
                        <span>kotlinx.coroutines</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../integrations/retrofit/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Retrofit</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../integrations/kindedj/index.html">
                        <i class="fa fa-circle"></i>
                        <span>KindedJ</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Free</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../free/free/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Free</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../free/freeapplicative/index.html">
                        <i class="fa fa-circle"></i>
                        <span>FreeApplicative</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../free/cofree/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Cofree</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../free/yoneda/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Yoneda</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../free/coyoneda/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Coyoneda</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Recursion Schemes</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../recursion/intro/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Intro</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/recursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Recursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/corecursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Corecursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/birecursive/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Birecursive</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/mu/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Mu</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/nu/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Nu</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../recursion/fix/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Fix</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
        <li class="sidebar-nav-item">
            <a href="index.html#">
                <span>Legal</span>
                
                <i class="fa fa-angle-right"></i>
                
            </a>
            
            <ul>
                
                <li>
                    <a href="../../../legal/credits/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Credits</span>
                    </a>
                </li>
                
                <li>
                    <a href="../../../legal/licenses/index.html">
                        <i class="fa fa-circle"></i>
                        <span>Licenses</span>
                    </a>
                </li>
                
            </ul>
            
        </li>
        
    </ul>

</div>

    <div id="doc-wrapper">
    <div class="doc-header">
        <button type="button" id="main-toggle" class="sidebar-toggle">
            <i class="fa fa-lg fa-bars menu-icon"></i>
        </button>
        <div class="search-wrapper">
          <input id="docsearch" class="search" placeholder="Search documentation..." type="search">
        </div>
        <a target="_blank"
          href="https://github.com/arrow-kt/arrow/edit/master/modules/docs/arrow-docs/docs/docs/arrow/data/eithert/README.md">
          <i class="fa fa-pencil"></i>
            Edit
        </a>
    </div>
    <div class="doc-content">
        
        <a class="button-video">
    <i class="fa fa-youtube-play"></i> Watch video
</a>

<div id="video-panel" class="video-panel">
    <h2><i class="fa fa-video-camera"></i> Video tutorial</h2>
    <div class="bg-video">
        <div class="wrapper-video">
            <div class="video-container">
                <iframe width="560" height="315"
                        src="https://www.youtube-nocookie.com/embed/1h4X8CrMjVs?rel=0&amp;showinfo=1"
                        frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
        </div>
    </div>
</div>

        
        <h2 id="eithert">EitherT</h2>

<p class="advanced">advanced</p>

<p><code class="highlighter-rouge">EitherT</code> also known as the <code class="highlighter-rouge">Either</code> monad transformer allows to compute inside the context when <code class="highlighter-rouge">Either</code> is nested in a different monad.</p>

<p>One issue we face with monads is that they donâ€™t compose. This can cause your code to get really hairy when trying to combine structures like <code class="highlighter-rouge">ObservableK</code> and <code class="highlighter-rouge">Either</code>. But thereâ€™s a simple solution, and weâ€™re going to explain how you can use Monad Transformers to alleviate this problem.</p>

<p>For our purposes here, weâ€™re going to utilize a monad that serves as a container that may hold a value and where a computation can be performed.</p>

<p>Given that both <code class="highlighter-rouge">ObservableK&lt;A&gt;</code> and <code class="highlighter-rouge">Either&lt;L, A&gt;</code> would be examples of datatypes that provide instances for the <code class="highlighter-rouge">Monad</code> typeclasses.</p>

<p>Because <a href="http://tonymorris.github.io/blog/posts/monads-do-not-compose/">monads donâ€™t compose</a>, we may end up with nested structures such as <code class="highlighter-rouge">ObservableK&lt;Either&lt;BizError, ObservableK&lt;Either&lt;BizError, A&gt;&gt;&gt;</code> when using <code class="highlighter-rouge">ObservableK</code> and <code class="highlighter-rouge">Either</code> together. Using Monad Transformers can help us to reduce this boilerplate.</p>

<p>In the most basic of scenarios, weâ€™ll only be dealing with one monad at a time making our lives nice and easy. However, itâ€™s not uncommon to get into scenarios where some function calls will return <code class="highlighter-rouge">ObservableK&lt;A&gt;</code>, and others will return <code class="highlighter-rouge">Either&lt;BizError, A&gt;</code>.</p>

<p>So letâ€™s test this out with an example:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.*</span>
<span class="k">import</span> <span class="nn">arrow.core.*</span>
<span class="k">import</span> <span class="nn">arrow.data.*</span>

<span class="kd">data class</span> <span class="nc">Country</span><span class="p">(</span><span class="kd">val</span> <span class="py">code</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span>
<span class="kd">data class</span> <span class="nc">Address</span><span class="p">(</span><span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="kd">val</span> <span class="py">country</span><span class="p">:</span> <span class="n">Option</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;)</span>
<span class="kd">data class</span> <span class="nc">Person</span><span class="p">(</span><span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">address</span><span class="p">:</span> <span class="n">Option</span><span class="p">&lt;</span><span class="n">Address</span><span class="p">&gt;)</span>
</code></pre></div></div>

<p>To model our known errors we will use an algebraic datatype expressed in Kotlin as a sealed hierarchy.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">sealed</span> <span class="kd">class</span> <span class="nc">BizError</span> <span class="p">{</span>
  <span class="kd">data class</span> <span class="nc">PersonNotFound</span><span class="p">(</span><span class="kd">val</span> <span class="py">personId</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="nc">BizError</span><span class="p">()</span>
  <span class="kd">data class</span> <span class="nc">AddressNotFound</span><span class="p">(</span><span class="kd">val</span> <span class="py">personId</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="nc">BizError</span><span class="p">()</span>
  <span class="kd">data class</span> <span class="nc">CountryNotFound</span><span class="p">(</span><span class="kd">val</span> <span class="py">addressId</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="nc">BizError</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">typealias</span> <span class="n">PersonNotFound</span> <span class="p">=</span> <span class="n">BizError</span><span class="p">.</span><span class="n">PersonNotFound</span>
<span class="k">typealias</span> <span class="n">AddressNotFound</span> <span class="p">=</span> <span class="n">BizError</span><span class="p">.</span><span class="n">AddressNotFound</span>
<span class="k">typealias</span> <span class="n">CountryNotFound</span> <span class="p">=</span> <span class="n">BizError</span><span class="p">.</span><span class="n">CountryNotFound</span>
</code></pre></div></div>

<p>We can now implement a naive lookup function to obtain the country code given a person result.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">fun</span> <span class="nf">getCountryCode</span><span class="p">(</span><span class="n">maybePerson</span> <span class="p">:</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">BizError</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;):</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span>
  <span class="n">maybePerson</span><span class="p">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">person</span> <span class="p">-&gt;</span>
    <span class="n">person</span><span class="p">.</span><span class="n">address</span><span class="p">.</span><span class="n">toEither</span><span class="p">({</span> <span class="n">AddressNotFound</span><span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="p">}).</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">address</span> <span class="p">-&gt;</span>
      <span class="n">address</span><span class="p">.</span><span class="n">country</span><span class="p">.</span><span class="n">fold</span><span class="p">({</span> <span class="n">CountryNotFound</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="n">id</span><span class="p">).</span><span class="n">left</span><span class="p">()</span> <span class="p">},</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">code</span><span class="p">.</span><span class="n">right</span><span class="p">()</span> <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>Nested flatMap calls flatten the <code class="highlighter-rouge">Either</code> but the resulting function starts looking like a pyramid and can easily lead to callback hell.</p>

<p>We can further simplify this case by using Arrow <code class="highlighter-rouge">binding</code> facilities
that enables monad comprehensions for all datatypes for which a monad instance is available.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.typeclasses.*</span>
<span class="k">import</span> <span class="nn">arrow.core.extensions.*</span>
<span class="k">import</span> <span class="nn">arrow.core.extensions.either.monad.*</span>

<span class="k">fun</span> <span class="nf">getCountryCode</span><span class="p">(</span><span class="n">maybePerson</span> <span class="p">:</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">BizError</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;):</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span>
  <span class="n">binding</span><span class="p">&lt;</span><span class="n">BizError</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">person</span><span class="p">)</span> <span class="p">=</span> <span class="n">maybePerson</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">address</span><span class="p">)</span> <span class="p">=</span> <span class="n">person</span><span class="p">.</span><span class="n">address</span><span class="p">.</span><span class="n">toEither</span><span class="p">({</span> <span class="n">AddressNotFound</span><span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="p">})</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">country</span><span class="p">)</span> <span class="p">=</span> <span class="n">address</span><span class="p">.</span><span class="n">country</span><span class="p">.</span><span class="n">toEither</span><span class="p">({</span> <span class="n">CountryNotFound</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="n">id</span><span class="p">)})</span>
    <span class="n">country</span><span class="p">.</span><span class="n">code</span>
  <span class="p">}.</span><span class="n">fix</span><span class="p">()</span>
</code></pre></div></div>

<p>Alright, a piece of cake right? Thatâ€™s because we were dealing with a simple type <code class="highlighter-rouge">Either</code>. But hereâ€™s where things can get more complicated. Letâ€™s introduce another monad in the middle of the computation. For example what happens when we need to load a person by id, then their address and country to obtain the country code from a remote service?</p>

<p>Consider this simple database representation:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">val</span> <span class="py">personDB</span><span class="p">:</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mapOf</span><span class="p">(</span>
  <span class="m">1</span> <span class="n">to</span> <span class="n">Person</span><span class="p">(</span>
        <span class="n">id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
        <span class="n">name</span> <span class="p">=</span> <span class="s">"Alfredo Lambda"</span><span class="p">,</span>
        <span class="n">address</span> <span class="p">=</span> <span class="n">Some</span><span class="p">(</span>
          <span class="n">Address</span><span class="p">(</span>
            <span class="n">id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
            <span class="n">country</span> <span class="p">=</span> <span class="n">Some</span><span class="p">(</span>
              <span class="n">Country</span><span class="p">(</span>
                <span class="n">code</span> <span class="p">=</span> <span class="s">"ES"</span>
              <span class="p">)</span>
            <span class="p">)</span>
          <span class="p">)</span>
        <span class="p">)</span>
      <span class="p">)</span>
<span class="p">)</span>

<span class="kd">val</span> <span class="py">adressDB</span><span class="p">:</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">,</span> <span class="n">Address</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mapOf</span><span class="p">(</span>
  <span class="m">1</span> <span class="n">to</span> <span class="n">Address</span><span class="p">(</span>
    <span class="n">id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
    <span class="n">country</span> <span class="p">=</span> <span class="n">Some</span><span class="p">(</span>
      <span class="n">Country</span><span class="p">(</span>
        <span class="n">code</span> <span class="p">=</span> <span class="s">"ES"</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Now weâ€™ve got two new functions in the mix that are going to call a remote service, and they return a <code class="highlighter-rouge">ObservableK</code>. This is common in most APIs that handle loading asynchronously.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.effects.rx2.*</span>

<span class="k">fun</span> <span class="nf">findPerson</span><span class="p">(</span><span class="n">personId</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="nc">ObservableK</span><span class="p">&lt;</span><span class="nc">Either</span><span class="err">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">Person</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
  <span class="n">ObservableK</span><span class="p">.</span><span class="n">just</span><span class="p">(</span>
    <span class="n">Option</span><span class="p">.</span><span class="n">fromNullable</span><span class="p">(</span><span class="n">personDB</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">personId</span><span class="p">)).</span><span class="n">toEither</span> <span class="p">{</span> <span class="n">PersonNotFound</span><span class="p">(</span><span class="n">personId</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">)</span> <span class="c1">//mock impl for simplicity</span>

<span class="k">fun</span> <span class="nf">findCountry</span><span class="p">(</span><span class="n">addressId</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="nc">ObservableK</span><span class="p">&lt;</span><span class="nc">Either</span><span class="err">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">Country</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
  <span class="n">ObservableK</span><span class="p">.</span><span class="n">just</span><span class="p">(</span>
    <span class="n">Option</span><span class="p">.</span><span class="n">fromNullable</span><span class="p">(</span><span class="n">adressDB</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">addressId</span><span class="p">))</span>
      <span class="p">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">country</span> <span class="p">}</span>
      <span class="p">.</span><span class="n">toEither</span> <span class="p">{</span> <span class="n">CountryNotFound</span><span class="p">(</span><span class="n">addressId</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">)</span> <span class="c1">//mock impl for simplicity</span>

</code></pre></div></div>

<p>A naive implementation attempt to get to a <code class="highlighter-rouge">country.code</code> from a <code class="highlighter-rouge">person.id</code> might look something like this.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">fun</span> <span class="nf">getCountryCode</span><span class="p">(</span><span class="nv">personId</span><span class="p">:</span> <span class="nc">Int</span><span class="p">)</span> <span class="p">=</span>
  <span class="n">findPerson</span><span class="p">(</span><span class="n">personId</span><span class="p">).</span><span class="n">map</span> <span class="p">{</span> <span class="n">maybePerson</span> <span class="p">-&gt;</span>
    <span class="n">maybePerson</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">person</span> <span class="p">-&gt;</span>
      <span class="n">person</span><span class="p">.</span><span class="n">address</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">address</span> <span class="p">-&gt;</span>
        <span class="n">findCountry</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="n">id</span><span class="p">).</span><span class="n">map</span> <span class="p">{</span> <span class="n">maybeCountry</span> <span class="p">-&gt;</span>
          <span class="n">maybeCountry</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">country</span> <span class="p">-&gt;</span>
            <span class="n">country</span><span class="p">.</span><span class="n">code</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>  
    <span class="p">}</span>
  <span class="p">}</span>

<span class="kd">val</span> <span class="py">lifted</span> <span class="p">=</span> <span class="p">{</span> <span class="nv">personId</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">-&gt;</span> <span class="n">getCountryCode</span><span class="p">(</span><span class="n">personId</span><span class="p">)</span> <span class="p">}</span>
<span class="n">lifted</span>
<span class="c1">// (kotlin.Int) -&gt; arrow.effects.rx2.ObservableK&lt;arrow.core.Either&lt;Line_2.BizError, arrow.core.Option&lt;arrow.effects.rx2.ObservableK&lt;arrow.core.Either&lt;Line_2.BizError, kotlin.String&gt;&gt;&gt;&gt;&gt;</span>
</code></pre></div></div>

<p>This isnâ€™t actually what we want since the inferred return type shows we are staking effects in a nested fashion.
We canâ€™t use flatMap in this case because the nested expression does not match the return type of the expression theyâ€™re contained within. This is because weâ€™re not flatMapping properly over the nested types.</p>

<p>Still not ideal. The levels of nesting are pyramidal with <code class="highlighter-rouge">flatMap</code> and <code class="highlighter-rouge">map</code> and are as deep as the number of operations that you have to perform.</p>

<p>Letâ€™s look at how a similar implementation would look like using monad comprehensions without transformers:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.effects.rx2.extensions.observablek.monad.*</span>

<span class="k">fun</span> <span class="nf">getCountryCode</span><span class="p">(</span><span class="nv">personId</span><span class="p">:</span> <span class="nc">Int</span><span class="p">):</span> <span class="nc">ObservableK</span><span class="p">&lt;</span><span class="nc">Either</span><span class="err">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
  <span class="n">binding</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">person</span> <span class="p">=</span> <span class="n">findPerson</span><span class="p">(</span><span class="n">personId</span><span class="p">).</span><span class="n">bind</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">address</span> <span class="p">=</span> <span class="n">person</span><span class="p">.</span><span class="n">fold</span> <span class="p">(</span>
      <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">address</span><span class="p">.</span><span class="n">toEither</span> <span class="p">{</span> <span class="n">AddressNotFound</span><span class="p">(</span><span class="n">personId</span><span class="p">)</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">)</span>
    <span class="kd">val</span> <span class="py">maybeCountry</span> <span class="p">=</span> <span class="n">address</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
      <span class="p">{</span> <span class="n">ObservableK</span><span class="p">.</span><span class="n">just</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">left</span><span class="p">())</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">findCountry</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">).</span><span class="n">bind</span><span class="p">()</span>
    <span class="kd">val</span> <span class="py">code</span> <span class="p">=</span> <span class="n">maybeCountry</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
        <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">code</span><span class="p">.</span><span class="n">right</span><span class="p">()</span> <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">code</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>While weâ€™ve got the logic working now, weâ€™re in a situation where weâ€™re forced to deal with the <code class="highlighter-rouge">Left cases</code>. We also have a ton of boilerplate type conversion with <code class="highlighter-rouge">fold</code>. The type conversion is necessary because in a monad comprehension you can only use a type of Monad. If we start with <code class="highlighter-rouge">ObservableK</code>, we have to stay in itâ€™s monadic context by lifting anything we compute sequentially to a <code class="highlighter-rouge">ObservableK</code> whether or not itâ€™s async.</p>

<p>This is a commonly encountered problem, especially in the context of async services. So how can we reconcile the fact that weâ€™re mixing <code class="highlighter-rouge">Either</code> and <code class="highlighter-rouge">ObservableK</code>?</p>

<h3 id="monad-transformers-to-the-rescue">Monad Transformers to the Rescue!</h3>

<p>Monad Transformers enable you to combine two monads into a super monad. In this case, weâ€™re going to use <code class="highlighter-rouge">EitherT</code>
from Arrow to express the effect of potential known controled biz error inside our async computations.</p>

<p><code class="highlighter-rouge">EitherT</code> has the form of <code class="highlighter-rouge">EitherT&lt;F, L, A&gt;</code>.</p>

<p>This means that for any monad <code class="highlighter-rouge">F</code> surrounding an <code class="highlighter-rouge">Either&lt;L, A&gt;</code> we can obtain an <code class="highlighter-rouge">EitherT&lt;F, L, A&gt;</code>.
So our specialization <code class="highlighter-rouge">EitherT&lt;ForObservableK, BizError, A&gt;</code> is the EitherT transformer around values that are of <code class="highlighter-rouge">ObservableK&lt;Either&lt;BizError, A&gt;&gt;</code>.</p>

<p>We can now lift any value to a <code class="highlighter-rouge">EitherT&lt;F, BizError, A&gt;</code> which looks like this:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.effects.rx2.extensions.observablek.applicative.*</span>

<span class="kd">val</span> <span class="py">eitherTVal</span> <span class="p">=</span> <span class="n">EitherT</span><span class="p">.</span><span class="n">just</span><span class="p">&lt;</span><span class="n">ForObservableK</span><span class="p">,</span> <span class="n">BizError</span><span class="p">,</span> <span class="n">Int</span><span class="p">&gt;(</span><span class="n">ObservableK</span><span class="p">.</span><span class="n">applicative</span><span class="p">(),</span> <span class="m">1</span><span class="p">)</span>
<span class="n">eitherTVal</span>
<span class="c1">// EitherT(value=ObservableK(observable=io.reactivex.internal.operators.observable.ObservableJust@79f76fc9))</span>
</code></pre></div></div>

<p>And back to the <code class="highlighter-rouge">ObservableK&lt;Either&lt;BizError, A&gt;&gt;</code> running the transformer</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">eitherTVal</span><span class="p">.</span><span class="n">value</span><span class="p">()</span>
<span class="c1">// ObservableK(observable=io.reactivex.internal.operators.observable.ObservableJust@79f76fc9)</span>
</code></pre></div></div>

<p>So how would our function look if we implemented it with the EitherT monad transformer?</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">arrow.data.extensions.eithert.monad.*</span>

<span class="k">fun</span> <span class="nf">getCountryCode</span><span class="p">(</span><span class="nv">personId</span><span class="p">:</span> <span class="nc">Int</span><span class="p">):</span> <span class="nc">ObservableK</span><span class="p">&lt;</span><span class="nc">Either</span><span class="err">&lt;</span><span class="nc">BizError</span><span class="p">,</span> <span class="nc">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
  <span class="n">EitherT</span><span class="p">.</span><span class="n">monad</span><span class="p">&lt;</span><span class="n">ForObservableK</span><span class="p">,</span> <span class="n">BizError</span><span class="p">&gt;(</span><span class="n">ObservableK</span><span class="p">.</span><span class="n">monad</span><span class="p">()).</span><span class="n">binding</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">person</span><span class="p">)</span> <span class="p">=</span> <span class="n">EitherT</span><span class="p">(</span><span class="n">findPerson</span><span class="p">(</span><span class="n">personId</span><span class="p">))</span>
    <span class="kd">val</span> <span class="py">address</span> <span class="p">=</span> <span class="n">EitherT</span><span class="p">(</span><span class="n">ObservableK</span><span class="p">.</span><span class="n">just</span><span class="p">(</span>
      <span class="n">person</span><span class="p">.</span><span class="n">address</span><span class="p">.</span><span class="n">toEither</span> <span class="p">{</span> <span class="n">AddressNotFound</span><span class="p">(</span><span class="n">personId</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">)).</span><span class="n">bind</span><span class="p">()</span>
    <span class="kd">val</span> <span class="p">(</span><span class="py">country</span><span class="p">)</span> <span class="p">=</span> <span class="n">EitherT</span><span class="p">(</span><span class="n">findCountry</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="n">id</span><span class="p">))</span>
    <span class="n">country</span><span class="p">.</span><span class="n">code</span>
  <span class="p">}.</span><span class="n">value</span><span class="p">().</span><span class="n">fix</span><span class="p">()</span>
</code></pre></div></div>

<p>Here we no longer have to deal with the <code class="highlighter-rouge">Left</code> cases, and the binding to the values on the left side are already the underlying values we want to focus on instead of the potential biz error values. We have automatically <code class="highlighter-rouge">flatMapped</code> through the <code class="highlighter-rouge">ObservableK</code> and <code class="highlighter-rouge">Either</code> in a single expression reducing the boilerplate and encoding the effects concerns in the type signatures.</p>

<h2 id="additional-syntax">Additional syntax</h2>

<p>As <code class="highlighter-rouge">EitherT&lt;F, A ,B&gt;</code> allows to manipulate the nested <code class="highlighter-rouge">Either</code> structure, it provides a <code class="highlighter-rouge">mapLeft</code> method to map over the left element of nested Eithers.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">arrow.core.extensions.option.functor.*</span>

<span class="n">EitherT</span><span class="p">(</span><span class="n">Option</span><span class="p">(</span><span class="m">3</span><span class="p">.</span><span class="n">left</span><span class="p">())).</span><span class="n">mapLeft</span><span class="p">(</span><span class="n">Option</span><span class="p">.</span><span class="n">functor</span><span class="p">(),</span> <span class="p">{</span><span class="n">it</span> <span class="p">+</span> <span class="m">1</span><span class="p">})</span>
<span class="c1">// EitherT(value=Some(Left(a=4)))</span>
</code></pre></div></div>

<h3 id="supported-type-classes">Supported type classes</h3>

<table>
  <tbody>
    <tr>
      <td>Module</td>
      <td>Type classes</td>
    </tr>
    <tr>
      <td><strong>arrow.effects.typeclasses</strong></td>
      <td><a href="https://next.arrow-kt.io/docs/arrow/effects/typeclasses/async">Async</a>, <a href="https://next.arrow-kt.io/docs/arrow/effects/typeclasses/bracket">Bracket</a>, <a href="https://next.arrow-kt.io/docs/arrow/effects/typeclasses/concurrenteffect">ConcurrentEffect</a>, <a href="https://next.arrow-kt.io/docs/arrow/effects/typeclasses/effect">Effect</a>, <a href="https://next.arrow-kt.io/docs/arrow/effects/typeclasses/monaddefer">MonadDefer</a></td>
    </tr>
    <tr>
      <td><strong>arrow.typeclasses</strong></td>
      <td><a href="https://next.arrow-kt.io/docs/arrow/typeclasses/applicative">Applicative</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/applicativeerror">ApplicativeError</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/contravariant">Contravariant</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/decidable">Decidable</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/divide">Divide</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/divisible">Divisible</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/foldable">Foldable</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/functor">Functor</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monad">Monad</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monaderror">MonadError</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/monadthrow">MonadThrow</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/semigroupk">SemigroupK</a>, <a href="https://next.arrow-kt.io/docs/arrow/typeclasses/traverse">Traverse</a></td>
    </tr>
    <tr>
      <td><strong>arrow.typeclasses.suspended.monaderror</strong></td>
      <td><a href="https://next.arrow-kt.io/docs/arrow/typeclasses/suspended/monaderror/fx">Fx</a></td>
    </tr>
  </tbody>
</table>

<p>Take a look at the <a href="https://next.arrow-kt.io/docs/arrow/data/optiont"><code class="highlighter-rouge">OptionT</code> docs</a> for an alternative version of this content with the <code class="highlighter-rouge">OptionT</code> monad transformer</p>

<h2 id="credits">Credits</h2>

<p>Contents partially adapted from <a href="https://www.47deg.com/blog/fp-for-the-average-joe-part-2-scalaz-monad-transformers/">FP for the avg Joe at the 47 Degrees blog</a></p>

    </div>
</div>

</div>
<!-- Jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Arrow playground -->
<script src="https://unpkg.com/arrow-playground@1" data-selector="[class^='language-kotlin']"></script>
<!-- Highlight -->
<script src="../../../../js/highlight.pack.js"></script>
<script>
  hljs.initHighlighting();
</script>
<!-- Docsearch -->
<script type="text/javascript" src="../../../../js/docsearch.min.js"></script>
<!-- Custom scripts for this template -->
<script src="../../../../js/functions.js"></script>
<!-- Gitter -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'arrow-kt/Lobby'
  };

</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

</body>
</html>
